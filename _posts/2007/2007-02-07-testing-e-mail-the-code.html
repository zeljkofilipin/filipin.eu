---
tags:  code ruby
title: 'Testing E-mail: The Code'
---
<p>Lately I have been testing e-mail functionality of web application. This is the fifth post about that experience. Last week I wrote about <a href="/testing-e-mail-lessons-learned">lessons learned</a>.</p>
<p>I have written a little framework that helps me with testing e-mail.</p>
<p>To use it, you will have to install <a href="http://www.ruby-lang.org/en/downloads/">Ruby</a>, <a href="/test-if-application-sends-correct-e-mails">Tmail</a> and <a href="/testing-e-mail-install-smtp-server">SMTP server</a>.</p>
<p>Then download <code>mail.zip</code> (2,20 KB) and extract it. No installation required. There are even some unit tests (<code>unit_tests.rb</code>) and example code (<code>usage.rb</code>).</p>
<p>Send mail.</p>

{% highlight ruby %}
SendMail.new(
  "user@domain",
  "application@domain",
  "title",
  "body").send
{% endhighlight %}

<p>Check if application sent mail that you have expected.</p>

{% highlight ruby %}
Mail.received?(
  [Mail.new(
    "application@domain",
    "user@domain",
    "title")])
{% endhighlight %}

<p>For now, mail that is sent can only contain <code>from</code>, <code>to</code>, <code>subject</code> and <code>body</code>. While receiving, I only check <code>from</code>, <code>to</code> and <code>subject</code></p>
<p>This is code that I am really using every day.</p>
<p>Please understand that I am a tester, not a developer, and I know that this code could be better. Feel free to improve it. Post bug reports and your comments here.</p>
